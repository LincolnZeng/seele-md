
# 挖矿

### 下载 Executables

根据操作系统从github上下载最新[可执行档和配置模板](https://github.com/seeleteam/go-seele/releases/latest)的zip文件，文件中build里是可执行档，另外4个.json文件为配置模板。

### 配置 node.json

更新node.json中的

### 启动 node 挖矿
### 使用 client 服务

# 编译 node

### 第一步（共3步）： 在终端里检查git，gcc，go版本

```bash
$ git --version
git version 2.17.1

$ gcc --version
gcc (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0
Copyright (C) 2017 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
​
$ go version
go version go1.10.4 linux/amd64
```

### 第二步（共3步）：下载go-seele来编译代码，移动配置文件夹
a. 下载go-seele：首先在根目录里创建路径：~/go/src/github.com/seeleteam。
```bash
~$ cd
~$ mkdir -p go/src/github.com/seeleteam
~$ cd go/src/github.com/seeleteam
~/go/src/github.com/seeleteam$ git clone https://github.com/seeleteam/go-seele.git

Cloning into 'go-seele'...
remote: Enumerating objects: 53, done.
remote: Counting objects: 100% (53/53), done.
remote: Compressing objects: 100% (48/48), done.
remote: Total 10032 (delta 13), reused 15 (delta 4), pack-reused 9979
Receiving objects: 100% (10032/10032), 12.25 MiB | 18.45 MiB/s, done.
Resolving deltas: 100% (5804/5804), done.

```
b. 编译go-seele：

```bash
~/go/src/github.com/seeleteam$ cd go-seele
~/go/src/github.com/seeleteam/go-seele$ make all
go build -o ./build/discovery ./cmd/discovery
Done discovery building
go build -o ./build/node ./cmd/node 
Done node building
go build -o ./build/client ./cmd/client
Done full node client building
go build -o ./build/light ./cmd/client/light
Done light node client building
go build -o ./build/tool ./cmd/tool
Done tool building
go build -o ./build/vm ./cmd/vm
Done vm building
~/go/src/github.com/seeleteam/go-seele$
```

c. 复制配置文档到编译目录里，方便以后挪动软件只需要挪动编译目录。
```bash
~/go/src/github.com/seeleteam/go-seele$ cp -rf cmd/node/config build
```
### 第三步（共3步）：产生钥匙对，保存账户，设置节点并启动节点
a. 产生一对公私钥作为账户：通过向./client key命令提供片数，--shard。文章的例子选择使用1片，虽然用户可以自由 选择2、3、4片并模仿以下操作。
```
~/go/src/github.com/seeleteam/go-seele/build$ ./client key --shard 1
public key:  0xae3177704461da49191c702a59390703a3720b61
private key: 0x8ae12c0e0fcb38e4917d617fcc2938385bd88f8fa549b3c24ae8cd1d2cee1a60
```

b. 保存账户和私有钥匙至keyfile：通过向./client savekey提供私钥，--privatekey，和保存到的文档名字--file。终端会请求输入文档的制作密码。请保留密码，秘钥和公钥。用户在丢失秘钥的情况下可以通过该文档和密码得知秘钥。在下面的例子中，被保存的私钥是：0x8ae12c0e0fcb38e4917d617fcc2938385bd88f8fa549b3c24ae8cd1d2cee1a60而keyfile文档名字用的是公钥的地址0xae3177704461da49191c702a59390703a3720b61。
```bash 
seele@seele-sw:~/go/src/github.com/seeleteam/go-seele/build$ ./client savekey \
--privatekey 0x8ae12c0e0fcb38e4917d617fcc2938385bd88f8fa549b3c24ae8cd1d2cee1a60 \
--file 0xae3177704461da49191c702a59390703a3720b61 
Password:*
Repeat password:*
store key successfully, the key file path is 0xae3177704461da49191c702a59390703a3720b61
```
注：如果keyfile要导入钱包，必须把keyfile文档名字设置为钥匙对的公钥。

注：用密码解锁keyfile的命令例子如下：
```bash
seele@seele-sw:~/go/src/github.com/seeleteam/go-seele/build$ ./client deckeyfile \
--file .\0xae3177704461da49191c702a59390703a3720b61
Please input your key file password: *
public key:  0xae3177704461da49191c702a59390703a3720b61
private key: 0x8ae12c0e0fcb38e4917d617fcc2938385bd88f8fa549b3c24ae8cd1d2cee1a60
```
c. 再生成一对公私钥来设置的node的ID。在这里生成的公私钥并不要求有和账户一样的片数，因此这个例子使用一个第二片的公私钥来证明这一点。
```bash 
seele@seele-sw:~/go/src/github.com/seeleteam/go-seele/build$ ./client key --shard 2
public key:  0x46a4560cadad593a0f3c32a8ac9d97eec06dd6c1
private key: 0xcd8388007c2e9cb87912ff3cdcfe4b265bf7fb08cae62ec5287f4f7c8eef5870
```
d. 选择配置文档。因为账户是用shard1来产生的，配置文档应该对应的选择在config里的node1.json文档。如果产生账户共秘钥的片数是2则使用node2.json，以此类推。
```bash
seele@seele-sw:~/go/src/github.com/seeleteam/go-seele/build$ vi config/node1.json
```
在vim或其他编译器中对配置文档进行修改。在vim里，按i键来进入insert mode，编辑后，esc键来回到normal mode。在normal mode里可以按:q!+enter不保存退出，如果修改有问题愿意重新开始；或者:wq!保存退出。在insert mode中，用箭头和复制粘贴的快捷键来进行以下修改：

basic.coinbase 将之前的引号中的公钥改成你的账户的公钥

p2p.privatekey将之前引号中的私钥改成你的后生成的node ID的公钥

p2p.staticNodes可以先用104.218.164.169:8057

修改后的效果如下：

```json
{
  "basic":{
    "name": "seele node1",
    "version": "1.0",
    "dataDir": "node1",
    "address": "0.0.0.0:8027",
    "coinbase": "0xae3177704461da49191c702a59390703a3720b61",
    "algorithm": "spow"
  },
  "p2p": {
    "privateKey": "0xcd8388007c2e9cb87912ff3cdcfe4b265bf7fb08cae62ec5287f4f7c8eef5870",
    "staticNodes": ["104.218.164.169:8057"],
    "address": "0.0.0.0:8057",
    "networkID": "seele"
  },
  "log": {
    "isDebug": false,
    "printLog": true
  },
  "httpServer": {
    "address": "0.0.0.0:8037",
    "crossorigins": [
      "*"
    ],
    "whiteHost": [
      "*"
    ]
  },
  "wsserver": {
    "address": "0.0.0.0:8047",
    "crossorigins": [
      "*"
    ]
  },
  "ipcconfig": {
    "name": "seele1.ipc"
  },
  "metrics": {
    "address": "0.0.0.0:8087",
    "duration": 10,
    "database": "influxdb",
    "username": "test",
    "password": "test123"
  },
  "genesis": {
    "difficult":5200000,
    "shard":1,
    "timestamp":1554099618
  }
}
```

e. 启动node：通过向./node start提供配置文档：

```bash 
seele@seele-sw:~/go/src/github.com/seeleteam/go-seele/build$ ./node start -c config/node1.json
```
终端会展示类似如下的画面，图中显示downloader指的是node已经在同步链了，同步结束后立刻回开始挖矿。另开一个终端开始使用client来了解自己的账户信息。

使用go-seele client
寻找其他节点
到client可执行文件所在的目录里，使用p2p peers命令、把正确的地址和端口喂给-a命令。地址应该一直是127.0.0.1因为毕竟node在本地执行；端口，在没有修改的情况下，片1端口配置为8027，片2为8028，片3为8029，片4为8026。下面的例子说明该片1的node已经在8027上链接到5个节点了。
```bash 
$ cd ~/go/src/github.com/seeleteam/go-seele/cmd/client
$ ./client p2p peers -a 127.0.0.1:8027
$ 5
```
查看余额
到client可执行文件所在的目录里，把所要查询的账户输入给getbalance --account命令、把正确的地址和端口输入给-a命令。
```bash 
$ cd ~/go/src/github.com/seeleteam/go-seele/cmd/client
$ ./client getbalance --account 0xae3177704461da49191c702a59390703a3720b61
1800000000
```